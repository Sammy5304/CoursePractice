<header class="mb-2">
  <nav class="d-flex align-items-center justify-content-end" aria-label="breadcrumb">
    <span class="text-muted">新增部門</span>
    <span class="text-muted me-2 ms-2">/</span>
    <a routerLink="/main/departments" class="d-flex align-items-center">
      <span>部門主檔</span>
    </a>
  </nav>
</header>

<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <div class="card-title h4 mt-2"><i class="bi bi-briefcase me-2"></i>新增部門</div>
  </div>
  <div class="card-body">
    <form
      class="row g-3"
      [formGroup]="createForm"
      novalidate
      (ngSubmit)="onSubmit()"
    >
      <div class="col-md-6">
        <label
          for="deptLevel"
          class="form-label"
        >部門層級 <span class="text-danger">*</span></label>
        <input
          type="text"
          class="form-control"
          placeholder="請輸入部門層級"
          formControlName="deptLevel"
          [class.is-invalid]="isFieldInvalid('deptLevel')"
          id="deptLevel"
          [(ngModel)]="department.level"
        >
        <div
          *ngIf="isFieldInvalid('deptLevel')"
          id="deptLevel-error"
          class="invalid-feedback"
        >
          {{ getFieldError('deptLevel') }}
        </div>
      </div>
      <div class="col-md-6">
        <label
          for="deptCode"
          class="form-label"
        >部門代碼 <span class="text-danger">*</span></label>
        <input
          type="text"
          class="form-control"
          placeholder="請輸入部門代碼"
          formControlName="deptCode"
          placeholder="英數字和底線，最多20字元，例: IT00"
          [class.is-invalid]="isFieldInvalid('deptCode')"
          id="deptCode"
          [(ngModel)]="department.code"
        >
        <div
          *ngIf="isFieldInvalid('deptCode')"
          id="deptCode-error"
          class="invalid-feedback"
        >
          {{ getFieldError('deptCode') }}
        </div>
      </div>
            <div class="col-md-6">
        <label
          for="parentDeptId"
          class="form-label"
        >上層部門 <span class="text-danger">*</span></label>
        <input
          type="text"
          class="form-control"
          placeholder="請輸入部門層級"
          formControlName="parentDeptId"
          [class.is-invalid]="isFieldInvalid('parentDeptId')"
          id="parentDeptId"
          [(ngModel)]="department.parentId"
        >
        <div
          *ngIf="isFieldInvalid('parentDeptId')"
          id="parentDeptId-error"
          class="invalid-feedback"
        >
          {{ getFieldError('parentDeptId') }}
        </div>
      </div>
      <div class="col-md-6">
        <label
          for="deptName"
          class="form-label"
        >部門名稱 <span class="text-danger">*</span></label>
        <input
          type="text"
          class="form-control"
          placeholder="請輸入部門名稱"
          formControlName="deptName"
          placeholder="英數字和底線，最多20字元，例: IT00"
          [class.is-invalid]="isFieldInvalid('deptName')"
          id="deptName"
          [(ngModel)]="department.name"
        >
        <div
          *ngIf="isFieldInvalid('deptName')"
          id="deptName-error"
          class="invalid-feedback"
        >
          {{ getFieldError('deptName') }}
        </div>
      </div>
      <div class="col-md-6">
        <label
          for="inputAddress2"
          class="form-label"
        >部門主管(選擇性)</label>
        <input
          class="form-control"
          id="managerEmpId"
          placeholder="請選擇部門主管"
          formControlName="managerEmpId"
          [class.is-invalid]="isFieldInvalid('managerEmpId')"
          [(ngModel)]="department.managerId"
        />
        <div
          *ngIf="isFieldInvalid('managerEmpId')"
          id="managerEmpId-error"
          class="invalid-feedback"
        >
          {{ getFieldError('managerEmpId') }}
        </div>
      </div>
      <div class="col-md-6">
        <label
          for="isActive"
          class="form-label"
        >部門狀態 <span class="text-danger">*</span></label>
        <div class="form-check form-switch d-flex align-items-center">
          <input
            class="form-check-input"
            type="checkbox"
            id="isActive"
            formControlName="isActive"
            [class.is-invalid]="isFieldInvalid('isActive')"
            [checked]="isEnabled"
            (change)="toggleEnabled($event)"
            [(ngModel)]="department.active"
          >
          <label
            class="form-check-label ms-2 mt-1"
            for="isActive"
          >{{ isEnabled ? '啟用' : '停用' }}</label>
        </div>
        <div
          *ngIf="isFieldInvalid('isActive')"
          id="isActive-error"
          class="invalid-feedback"
        >
          {{ getFieldError('isActive') }}
        </div>
      </div>
      <div class="col-12 text-end">
        <button
          type="button"
          class="btn btn-outline-danger me-3"
          (click)="onCreateCancel()"
        ><i class="bi bi-x-lg me-2"></i>取消</button>
        <button
          type="button"
          class="btn btn-outline-secondary me-3"
          (click)="onReset()"
        ><i class="bi bi-arrow-clockwise me-2"></i>重設</button>
        <button
          type="submit"
          class="btn btn-outline-primary me-3"
        ><i class="bi bi-check-lg me-2"></i>確定新增</button>
      </div>
    </form>
  </div>
</div>